# boat-api Testing

## Pre-Clean
* clean datastore manually: `dev_appserver.py -c app.yaml`
* OR use a loop of GET and DELETE for boats and slips

# Boat: Read All

## Test 1: Get all boats

### Request

```
GET /boats/

```

### Expected Response

* Status is 200

* Body has an array of Empty JSON

  ```
  []
  ```
* Save `test1 = True` if this test passes, `false` otherwise

# Boat: Create & Read Boat

## Test 2: Create a new boat

### Request

* Save `test2name` as the `name` requested
* Save `test2type` as the `type` requested
* Save `test2length` as the `length` requested

```
POST /boats/

{
  "name": "Boat Name",
  "type": "Boat Type",
  "length": 10
}
```

### Expected Response

* Status is 201

* JSON that matches request data and also includes `id`, `url`, and `at_sea` set to `true`
  ```
  {
    "name": "Boat Name",
    "type": "Boat Type",
    "length": 10,
    "id": "asdfASDF1234-5678",
    "url": "http://.../boats/asdfASDF1234-5678",
    "at_sea": true
  }
  ```
* Save `test2url` as `url` given if this test passes, `null` otherwise

* Save `test2id` as `id` given if this test passes, `null` otherwise

* Save `test2response` as the JSON object if this test passes, `null` otherwise

## Test 3: URL from Test 2 Works

### Request

Verify boat was created using `url` from **Test 2**

```
GET {test2url}

```

### Expected Response

  * Status is 200

  * JSON that matches request data from **Test 2** and also includes `id` and `url` from **Test 2**, and `at_sea` is set to `true`.

  ```
  {
    "name": "Boat Name",
    "type": "Boat Type",
    "length": 10,
    "id": "asdfASDF1234-5678",
    "url": "http://.../boats/asdfASDF1234-5678",
    "at_sea": true
  }
  ```

## Test 4: ID from Test 2 Works

### Request

Verify boat was created using `id` from **Test 2**

```
GET /boats/{test2id}

```

### Expected Response

  * Status is 200

  * JSON that matches request data from **Test 2** and also includes `id` and `url` from **Test 2**, and `at_sea` is set to `true`.

  ```
  {
    "name": "Boat Name",
    "type": "Boat Type",
    "length": 10,
    "id": "asdfASDF1234-5678",
    "url": "http://.../boats/asdfASDF1234-5678",
    "at_sea": true
  }
  ```

## Test 5: Get All Boats After Test 2

### Request

Verify boat was added to list of all boats

```
GET /boats/

```

### Expected Response

* Status is 200

* If `test1 == True,` then continue with this test, otherwise fail

* Body has an array of JSON that has 1 element that matches the request data from **Test 2** and also includes `id` and `url` from **Test 2**, and `at_sea` is set to `true`.

  ```
  [
    {
      "name": "Boat Name",
      "type": "Boat Type",
      "length": 10,
      "id": "asdfASDF1234-5678",
      "url": "http://.../boats/asdfASDF1234-5678",
      "at_sea": true
    }
  ]
  ```




# Boat: Edit Boat

## Test 6: Edit Boat Name, Type, Length

### Request


* Save `test6name` as the `name` requested
* Save `test6type` as the `type` requested
* Save `test6length` as the `length` requested

```
PATCH /boats/{id}

{
  "name": "NEW Boat Name",
  "type": "NEW Type",
  "length": 20
}

```

### Expected Response

* Status is 200

* JSON that matches request data and also includes `id`, `url`, and `at_sea` set to `true`.
  ```
  {
    "name": "NEW Boat Name",
    "type": "NEW Boat Type",
    "length": 20,
    "id": "asdfASDF1234-5678",
    "url": "http://.../boats/asdfASDF1234-5678",
    "at_sea": true
  }
  ```



## Test 7: Check Boat Updated Correctly
### Request

```
GET /boats/{id}

```

### Expected Response

* Status is 200

* Body has JSON that matches the request of Test 6, includes `id`, `url`, and `at_sea` set to `true`.
  ```
  {
    "name": "NEW Boat Name",
    "type": "NEW Boat Type",
    "length": 20,
    "id": "asdfASDF1234-5678",
    "url": "http://.../boats/asdfASDF1234-5678",
    "at_sea": true
  }
  ```


# Slip: Read All Slips

## Test 8: Get all slips

### Request

```
GET /slips/

```

### Expected Response

* Status is 200

* Body has an array of Empty JSON

  ```
  []
  ```
* Save `test8 = True` if this test passes, `false` otherwise



# Slip: Create & Read Slip

## Test 9: Create a new slip

### Request

* Save `test9number` as the `number` requested

```
POST /slips/

{
  "number": 17
}
```

### Expected Response

* Status is 201

* JSON that matches request data and also includes autogenerated `id` and `url`, as well as default values for `current_boat` (`null`), `current_boat_url` (`null`), `arrival_date` (`null`), and `departure_history`  (empty array `[]`)
	```
	{           
		"number": 17,                
		"current_boat": null,
		"current_boat_url": null,  
		"arrival_date": null,  
		"departure_history": [],
		"id": "asdfASDF1234-1111",
		"url": "http://.../slips/asdfASDF1234-1111"
	}
	```
* Save `test9url` as `url` given if this test passes, `null` otherwise

* Save `test9id` as `id` given if this test passes, `null` otherwise

* Save `test9response` as the JSON object if this test passes, `null` otherwise


## Test 10: URL from Test 9 Works

### Request

Verify slip was created using `url` from **Test 9**

```
GET {test9url}

```

### Expected Response

  * Status is 200

  * JSON that matches request data from **Test 9** and also includes `id` and `url` from **Test 9**. Response has default values for `current_boat` (`null`), `current_boat_url` (`null`), `arrival_date` (`null`), and `departure_history`  (empty array `[]`).

  ```
	{           
	  "number": 17,                
	  "current_boat": null,   
		"current_boat_url": null,  
	  "arrival_date": null,  
	  "departure_history": [],
	  "id": "asdfASDF1234-1111",
	  "url": "http://.../slips/asdfASDF1234-1111"
  }
  ```

## Test 11: ID from Test 9 Works

### Request

Verify slip was created using `id` from **Test 9**

```
GET /slips/{test9id}

```

### Expected Response

  * Status is 200

  * JSON that matches request data from **Test 9** and also includes `id` and `url` from **Test 9**. Response has default values for `current_boat` (`null`), `current_boat_url` (`null`), `arrival_date` (`null`), and `departure_history`  (empty array `[]`).

	```
	{           
	  "number": 17,                
	  "current_boat": null,  
		"current_boat_url": null,   
	  "arrival_date": null,  
	  "departure_history": [],
	  "id": "asdfASDF1234-1111",
	  "url": "http://.../slips/asdfASDF1234-1111"
  }
  ```

## Test 12: Get All Slips After Test 9

### Request

Verify slip was added to list of all slips

```
GET /slips/

```

### Expected Response

* Status is 200

* If `test8 == True,` then continue with this test, otherwise fail

* Body has an array of JSON that has 1 element that matches the request data from **Test 9** and also includes `id` and `url` from **Test 9**. Response has default values for `current_boat` (`null`), `current_boat_url` (`null`), `arrival_date` (`null`), and `departure_history`  (empty array `[]`).

  ```
  [
		{           
			"number": 17,                
			"current_boat": null,   
			"current_boat_url": null,    
			"arrival_date": null,  
			"departure_history": [],
			"id": "asdfASDF1234-1111",
			"url": "http://.../slips/asdfASDF1234-1111"
		}
  ]
  ```


# Slip: Edit Slip
## Test 13: Edit Slip Number

### Request

```
PATCH /slips/{test9id}

{
  "number": 38
}

```

### Expected Response

* Status is 200

* JSON that matches request data changes and the rest of the slip is unchanged (check against `test9response`).

  ```
	{           
		"number": 38,                
		"current_boat": null,   
		"current_boat_url": null,    
		"arrival_date": null,  
		"departure_history": [],
		"id": "asdfASDF1234-1111",
		"url": "http://.../slips/asdfASDF1234-1111"
	}
  ```

## Test 14: Check Slip Number Updated Correctly

### Request

```
GET /slips/{test9id}

```

### Expected Response

* Status is 200

* Body has JSON that matches the request of Test 13 and the rest of the slip is unchanged (check against `test9response`).

	```
	{           
		"number": 38,                
		"current_boat": null,   
		"current_boat_url": null,    
		"arrival_date": null,  
		"departure_history": [],
		"id": "asdfASDF1234-1111",
		"url": "http://.../slips/asdfASDF1234-1111"
	}
	```


# Boat Arrival Case 1

Place an at sea boat into an empty slip.

## Test 15: Verify Slip is Empty

### Request

```
GET /slips/{test9id}

```

### Expected Response
* Status is 200

* JSON that has `id` that matches the requested value. JSON has `current_boat` is `null`, `current_boat_url` is `null`, and `arrival_date` is `null`.


```
{           
	"number": 17,                
	"current_boat": null,  
	"current_boat_url": null,   
	"arrival_date": null,  
	"departure_history": [],
	"id": "asdfASDF1234-1111",
	"url": "http://.../slips/asdfASDF1234-1111"
}
```
* Save `test15slip` with the JSON slip response.


## Test 16: Verify Boat is At Sea

### Request

Verify boat is at sea.

```
GET /boats/{test2id}

```

### Expected Response

* Status is 200

* JSON that has `id` that matches the requested value. JSON has `at_sea` equal to `true`.

```
{
  "name": "NEW Boat Name",
  "type": "NEW Boat Type",
  "length": 20,
  "id": "asdfASDF1234-5678",
  "url": "http://.../boats/asdfASDF1234-5678",
  "at_sea": true
}
```

* Save `test16boat` with the JSON boat response.


## Test 17: Boat Arrival

### Request

* Save `test17arrival_date` for future use.

```
PUT /boats/{test2id}/slips/{test9id}

{
	"arrival_date", "1/15/2016"
}
```

### Expected Response

* Status is 204

* No Content


## Test 18: Verify Boat is Not at Sea

### Request

Verify boat is not at sea.

```
GET /boats/{test2id}

```

### Expected Response

  * Status is 200

  * JSON that matches `test16boat` except for `at_sea` is equal to `false`.

  ```
  {
    "name": "NEW Boat Name",
    "type": "NEW Boat Type",
    "length": 20,
    "id": "asdfASDF1234-5678",
    "url": "http://.../boats/asdfASDF1234-5678",
    "at_sea": false
  }
  ```
* Save `test18 = true` if test passes, `false` otherwise.

* Save `test18response` as JSON of response.

## Test 19: Verify Slip lists the Boat and URL

### Request

```
GET /slips/{test9id}

```

### Expected Response
* Status is 200

* JSON that that matches `test15slip` except for `current_boat` is equal to `id` of `test16boat`, `current_boat_url` is equal to `url` of `test16boat`, and `arrival_date` matches requested date (`test17arrival_date`).

* `arrival_date` must be a date string in the form of `mm/dd/yyyy`

```
{           
	"number": 17,                
	"current_boat": "asdfASDF1234-5678",  
	"current_boat_url": "http://.../boats/asdfASDF1234-5678",   
	"arrival_date": "1/15/2016",  
	"departure_history": [],
	"id": "asdfASDF1234-1111",
	"url": "http://.../slips/asdfASDF1234-1111"
}
```
* Save `test19 = true` if test passes, `false` otherwise.

* Save `test19response` as JSON of response.


# Boat Departure

* If `test18 == true` and `test19 == true`, then continue with this group of tests, otherwise fail. (That is, Boat is Not At Sea and Slip has the Boat.)


## Test 20: Boat Departs Slip

### Request

* If `test18 == true` and `test19 == true`, then continue with this test, otherwise fail. (That is, Boat is Not At Sea and Slip has the Boat.)

* Save `test20departure_date` for future use.

* query parameter `departure` must be a date string in the form of `mm/dd/yyyy`

```
DELETE /boats/{test2id}/slips/{test9id}?departure={datestring}
```

### Expected Response

* Status is 204

* No Content


## Test 21: Verify Slip is Empty and Departure History is Updated

### Request

Verify slip is empty, and departure_history Updated. Compare with boat from `test19response`.

```
GET /slips/{test9id}

```

### Expected Response

* Status is 200

* JSON that matches `test19response`, except `current_boat` (`null`), `current_boat_url` (`null`), `arrival_date` (`null`).

* Verify `departure_history` is the same as that in `test19response` except for the addition of the `current_boat` from `test19response` and the `departure_date` from `test20departure_date`.

```
{           
  "number": 17,                
  "current_boat": null,  
	"current_boat_url": null,   
  "arrival_date": null,  
  "departure_history": [
		{"departure_date": "2/1/2016", "departed_boat": "asdfASDF1234-5678"}
	],
  "id": "asdfASDF1234-1111",
  "url": "http://.../slips/asdfASDF1234-1111"
}
```

## Test 22: Verify Boat Updated to At Sea

### Request

Verify boat is at sea and unchanged otherwise.

```
GET /boats/{test2id}

```

### Expected Response

* Status is 200

* JSON that matches `test18response`, except `at_sea = true`.

```
{
  "name": "NEW Boat Name",
  "type": "NEW Boat Type",
  "length": 20,
  "id": "asdfASDF1234-5678",
  "url": "http://.../boats/asdfASDF1234-5678",
  "at_sea": true
}
```

# Delete Occupied Slip

## Test 23: Pair a boat and slip (Boat Arrival)

### Request

* Save `test23arrival_date` for future use.

```
PUT /boats/{test2id}/slips/{test9id}

{
	"arrival_date", "3/15/2016"
}
```

### Expected Response

* Status is 204

* No Content


## Test 24: Check Slip is Not Empty

### Request

Verify slip is NOT empty

```
GET /slips/{test9id}

```

### Expected Response

  * Status is 200

  * JSON that has non-`null` values for `current_boat`, `current_boat_url`, and `arrival_date`.

	```
	{           
	  "number": 38,
		"current_boat": "asdfASDF1234-5678",                
	  "current_boat_url": "http://.../boats/asdfASDF1234-5678",   
	  "arrival_date": "3/15/2016",
	  "departure_history": [],
	  "id": "asdfASDF1234-1111",
	  "url": "http://.../slips/asdfASDF1234-1111"
  }
  ```

## Test 25: Check Boat is NOT at sea

### Request

Verify boat is not `at_sea`.

```
GET /boats/{test2id}

```

### Expected Response

  * Status is 200

  * JSON that has `at_sea` set to `false`.

  ```
  {
    "name": "Boat Name",
    "type": "Boat Type",
    "length": 10,
    "id": "asdfASDF1234-5678",
    "url": "http://.../boats/asdfASDF1234-5678",
    "at_sea": false
  }
  ```

## Test 26: Delete Occupied Slip

### Request

```
DELETE /slips/{test9id}

```

### Expected Response

* Status is 204

* No Content



## Test 27: Check Slip Deleted

### Request

Verify slip is deleted

```
GET /slips/{test9id}

```

### Expected Response

  * Status is 404


## Test 28: Check Boat Updated to At Sea

### Request

Verify boat is `at_sea`.

```
GET /boats/{test2id}

```

### Expected Response

  * Status is 200

  * JSON that has `at_sea` set to `true`.

  ```
  {
    "name": "Boat Name",
    "type": "Boat Type",
    "length": 10,
    "id": "asdfASDF1234-5678",
    "url": "http://.../boats/asdfASDF1234-5678",
    "at_sea": true
  }
  ```


# Delete Docked Boat

## Test 29: Create New Slip

## Test 30: Dock boat into new slip

## Test 31: Delete Docked Boat

## Test 32: Verify Boat Deleted

## Test 33: Verify Slip is empty & updated history
















# Boat Arrival Case 2

Try to place an at sea boat into an occupied slip and get denied. No changes.

## Test 34: Create new Boat #1

## Test 35: Create new Boat #2

## Test 36: Boat #1 Arrives in Slip

## Test 37: Verify Slip is Occupied

## Test 38: Boat #2 Arrival Denied (403 - Slip Occupied)

## Test 39: Verify Boat #1 is Unchanged

## Test 40: Verify Boat #2 is Unchanged

## Test 41: Verify Slip is Unchanged



# Boat Arrival Case 3

Try to place a docked boat into an empty slip and get denied. No changes.

## Test 42: Verify Slip (#1) is Occupied by Boat #1

## Test 43: Verify Boat #1 is Not At Sea

## Test 44: Create new Slip (#2)

## Test 45: Verify Slip #2 is Empty

## Test 46: Boat #1 Arrival to Slip #2 Denied (403)

## Test 47: Verify Boat #1 is Still Not At Sea

## Test 48: Verify Slip #2 is Still Empty

## Test 49: Verify Slip #1 is Unchanged



# Boat Arrival Case 4

Try to place a docked boat into an occupied slip and get denied. No changes.

## Test 50: Verify Slip #1 is Occupied By Boat #1

## Test 51: Verify Boat #1 is Not At Sea

## Test 52: Boat #2 Arrival to Slip #2

## Test 53: Verify Slip #2 is Occupied By Boat #2

## Test 54: Verify Boat #2 is Not At Sea

## Test 55: Boat #1 to Slip #2 Denied (403)

## Test 56: Verify Slip #1 is Unchanged

## Test 57: Verify Slip #2 is Unchanged

## Test 58: Verify Boat #1 is Unchanged

## Test 59: Verify Boat #2 is Unchanged
